<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>jRooms</title>
  <link rel="stylesheet" href="./lib/bootstrap/bootstrap.css"/>
  <link rel="stylesheet" href="/lib/bootstrap-datepicker/datepicker3.css"/>
  <link rel="stylesheet" href="./css/style.css"/>
</head>
<body>
  <!-- Fixed navbar -->
  <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">jRooms</a>
      </div>
      <div id="navbar" class="navbar-collapse collapse">
        <ul class="nav navbar-nav">
          <li><a id="homeLink" href="index.html">Home</a></li>
          <li  class="active" id="adminLink"><a href="admin.html">Admin</a></li>
          <li><a href="faq.html">Issues?</a></li>
          <li><a href="about.html">About</a>
         </ul>
         <ul class="nav navbar-nav navbar-right">
         <li><a class="text-info" id="loginInfo"></a></li>
         <li><a href="#" id="loginButton">Login</a></li>
         </ul>
      </div><!--/.nav-collapse -->
    </div>
  </nav>

  <div class="container well well-lg">
    <h3>Import OpenJUB data</h3>
    <p>We will use your auth token to retrieve a list of students from OpenJUB.</p> <p class="text-danger">Please, note, that this step is a prerequisite for everything else to work.</p>
    <a class="btn btn-default btn-danger" href="#importjub" onclick="" role="button">Let's do it!</a>
  </div>

  <div class="container well well-lg">
    <h3>Set phases</h3>
    <p>Here you can describe the phases of room allocation process and their time slots. For each phase ...</p>

    <div class="panel-group" id="phaseList" role="tablist" aria-multiselectable="true">
      <div id="phase0" class="hidden">
        <div class="panel panel-default">
          <div class="panel-heading" role="tab" id="phaseHeading0">
            <h4 class="panel-title">
              <a class="collapsed" data-toggle="collapse" href="#phasePanel0" aria-expanded="true" aria-controls="phasePanel0">
                New phase
              </a>
            </h4>
          </div>
          <div id="phasePanel0" class="panel-collapse collapse" role="tabpanel" aria-labelledby="phaseHeading0">
            <div class="panel-body">
              <form class="form-inline">
                <div class="form-group">
                  <input type="text" class="form-control" id="phaseName0" placeholder="Name">
                </div>
                <div class="form-group">
                  <input type="text" class="form-control" data-provide="datepicker" data-date-format="dd/mm/yy" id="phaseFrom0" placeholder="From">
                </div>
                <div class="form-group">
                  <input type="text" class="form-control" data-provide="datepicker" data-date-format="dd/mm/yy" id="phaseTo0" placeholder="To">
                </div>
                <br/>
                <br/>
                <a class="btn btn-default btn-success" href="#save" id="phaseSave0" onclick="savePhase(this.id);" role="button">Save</a>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="container well well-lg">
    <h3>Tall people</h3>
    <p>Modify list of people, who are eligible for a tall room. Please, enter CampusNet usernames separated by commas.</p>

    <div class="form-group">
      <textarea class="form-control" id="tallPeople" rows="4" placeholder="dcucleschi,fstankovsk,vungureanu"></textarea>
    </div>
  </div>

  <div class="container well well-lg">
    <h3>Modify user's information</h3>
    <p>If for some reason CampusNet data imported from OpenJUB is not accurate, you can use this section to manually edit user's information.</p>

    <div class="form-group">
      <input type="text" class="form-control" id="modifyUsername" placeholder="CampusNet username">
    </div>
  </div>

  <div class="container well well-lg">
    <h3>Disabled rooms</h3>
    <p>Modify list of rooms, which are excluded from the room allocation process. Please, enter room numbers separated by commas.</p>

    <div class="form-group">
      <textarea class="form-control" id="disabledRooms" rows="4" placeholder="KC302,MA108,CC326,NB220"></textarea>
    </div>
  </div>

  <div class="container well well-lg">
    <h3>Email options</h3>
    <p>Don't spam the community too much!</p>
    <div class="form-grouo">
      <div class="checkbox">
        <label>
        <input type="checkbox" id="email1">
          Case number 1
        </label>
      </div>
      <div class="checkbox">
        <label>
        <input type="checkbox" id="email2">
          Case number 2
        </label>
      </div>
      <div class="checkbox">
        <label>
        <input type="checkbox" id="email3">
          Case number 3
        </label>
      </div>
    </div>
  </div>

  <div class="container well well-lg">
    <h3>Import/export settings</h3>
    <p>Here you can backup or restore your settings from a generated JSON file.</p> 

    <form class="form-inline">
      <br/>
      <a class="btn btn-default btn-info" href="#exportSettings" onclick="" role="button">Export settings</a>
      <br/></br>
      <div class="form-group">
        <input class="form-control" type="file" id="importFile">
      </div>
      <a class="btn btn-default btn-info" href="#importSettings" onclick="" role="button">Import settings</a>
    </form>
  </div>

  <div class="container well well-lg">
    <h3>Export results</h3>
    <p>You can export results for a specific phase or for allocation process overall</p>
    
    <div class="form-group">
      <select class="form-control" id="exportPhases">
        <option>Final results (all allocated rooms)</option>
        <option>[ Here goes the current phase list ]</option>
      </select>
    </div>

    <a class="btn btn-default btn-info" href="#exportPhase" onclick="" role="button">Export</a>
  </div>

  <div class="container well well-lg">
    <h3>Reset the system</h3>
    <p class="text-danger">This will reset the system for the new allocation process. All the settings, user data and allocation results will be permanently deleted!</p>
    <a class="btn btn-default btn-danger" href="#clear" onclick="" role="button">I understand and choose to delete everything</a>
  </div>

  <script src="./lib/jquery/jquery.js"></script>
  <script src="./lib/jquery-cookie/jquery.cookie.js"></script>
  <script src="./lib/bootstrap/bootstrap.js"></script>
  <script src="./lib/bootstrap-datepicker/bootstrap-datepicker.js"></script>
  <script src="./js/openjub.js"></script>
  <script src="./js/utils.js"></script>
  <script>
      if (!JUB.loggedIn) {
        window.location = 'index.html';
      }

      window.addEventListener('JUB.LoginUpdated', function() {
        if (!JUB.loggedIn) {
          window.location = 'index.html';
        }

        updateNav();
      });

      var settings = {};
      var phaseCount = 0;
      var phaseTemplate = $('#phase0');
      var phaseList = $('#phaseList');

      var newPhase = function() {
        ++phaseCount;

        var phaseHTML = phaseTemplate.html();
        phaseHTML = phaseHTML.replace(/0/g, phaseCount);

        phaseList.append('<div id="phase' + phaseCount + '">');
        phaseList.append(phaseHTML);
        phaseList.append('</div>');
      };

      var savePhase = function(id) {
        id = parseInt(id.replace('phaseSave',''));
        console.log(id, phaseCount);

        if (id === phaseCount) {
          newPhase();
        }
      }

      window.onload = function() {
        updateNav();

        if (phaseCount == 0) {
          newPhase();
        }
      };
  </script>
</body>
</html>